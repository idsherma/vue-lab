<h1>Browserslist</h1>

<p><img align="right" width="120" height="120" src="./logo.svg" alt="Browserslist logo by Anton Lovchikov" /></p>

<p>Library to share target browsers between different front-end tools.
It is used in:</p>

<ul>
  <li><a href="https://github.com/postcss/autoprefixer">Autoprefixer</a></li>
  <li><a href="https://github.com/babel/babel-preset-env">babel-preset-env</a>
(external config in <code>package.json</code> or <code>browserslist</code> files supported in 2.0)</li>
  <li><a href="https://github.com/amilajack/eslint-plugin-compat">eslint-plugin-compat</a></li>
  <li><a href="https://github.com/ismay/stylelint-no-unsupported-browser-features">stylelint-no-unsupported-browser-features</a></li>
  <li><a href="https://github.com/jonathantneal/postcss-normalize">postcss-normalize</a></li>
</ul>

<p>All tools that rely on Browserslist will find its config automatically,
when you add the following to <code>package.json</code>:</p>

<p><code>json
{
  "browserslist": [
    "> 1%",
    "last 2 versions"
  ]
}
</code></p>

<p>Or in <code>.browserslistrc</code> config:</p>

<p>```yaml
# Browsers that we support</p>

<blockquote>
  <p>1%
Last 2 versions
IE 10 # sorry
```</p>
</blockquote>

<p>Developers set browsers list in queries like <code>last 2 version</code>
to be free from updating browser versions manually.
Browserslist will use <a href="http://caniuse.com/">Can I Use</a> data for this queries.</p>

<p>Browserslist will take browsers queries from tool option,
<code>browserslist</code> config, <code>.browserslistrc</code> config,
<code>browserslist</code> section in <code>package.json</code> or environment variables.</p>

<p>You can test Browserslist queries in <a href="http://browserl.ist/">online demo</a>.</p>

<p><a href="https://evilmartians.com/?utm_source=browserslist">
  <img src=”https://evilmartians.com/badges/sponsored-by-evil-martians.svg”
    alt=”Sponsored by Evil Martians”
    width=”236”
    height=”54”
  >
</a></p>

<h2>Tools</h2>

<ul>
  <li><a href="https://github.com/pastelsky/browserslist-useragent">browserslist-useragent</a> check browser by user agent string
to match Browserslist target browsers query.</li>
  <li>Run <code>npx browserslist</code> in your project directory to see project’s
target browsers. This CLI tool is built-in and available in any project
with Autoprefixer.</li>
</ul>

<h2>Queries</h2>

<p>Browserslist will use browsers query from one of this sources:</p>

<ol>
  <li>Tool options. For example <code>browsers</code> option in Autoprefixer.</li>
  <li><code>BROWSERSLIST</code> environment variable.</li>
  <li><code>browserslist</code> config file in current or parent directories.</li>
  <li><code>.browserslistrc</code> config file in current or parent directories.</li>
  <li><code>browserslist</code> key in <code>package.json</code> file in current or parent directories.
<strong>We recommend this way.</strong></li>
  <li>If the above methods did not produce a valid result
Browserslist will use defaults: <code>> 1%, last 2 versions, Firefox ESR</code>.</li>
</ol>

<p>You can specify the versions by queries (case insensitive):</p>

<ul>
  <li><code>last 2 versions</code>: the last 2 versions for each browser.</li>
  <li><code>last 2 Chrome versions</code>: the last 2 versions of Chrome browser.</li>
  <li><code>> 5%</code>: versions selected by global usage statistics.
<code>>=</code>, <code><</code> and <code><=</code> work too.</li>
  <li><code>> 5% in US</code>: uses USA usage statistics. It accepts <a href="http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2#Officially_assigned_code_elements">two-letter country code</a>.</li>
  <li><code>> 5% in alt-AS</code>: uses Asia region usage statistics. List of all region codes
can be found at <a href="https://github.com/ben-eb/caniuse-lite/tree/master/data/regions"><code>caniuse-lite/data/regions</code></a>.</li>
  <li><code>> 5% in my stats</code>: uses <a href="#custom-usage-data">custom usage data</a>.</li>
  <li><code>extends browserslist-config-mycompany</code>: take queries from
<code>browserslist-config-mycompany</code> npm package.</li>
  <li><code>ie 6-8</code>: selects an inclusive range of versions.</li>
  <li><code>Firefox > 20</code>: versions of Firefox newer than 20.
<code>>=</code>, <code><</code> and <code><=</code> work too.</li>
  <li><code>iOS 7</code>: the iOS browser version 7 directly.</li>
  <li><code>Firefox ESR</code>: the latest [Firefox ESR] version.</li>
  <li><code>unreleased versions</code> or <code>unreleased Chrome versions</code>:
alpha and beta versions.</li>
  <li><code>last 2 major versions</code> or <code>last 2 iOS major versions</code>:
all minor/patch releases of last 2 major versions.</li>
  <li><code>since 2013</code>: all versions released since year 2013
(also <code>since 2013-03</code> and <code>since 2013-03-10</code>).</li>
  <li><code>not ie <= 8</code>: exclude browsers selected by previous queries.</li>
</ul>

<p>You can add <code>not </code> to any query.</p>

<h3>Debug</h3>

<p>Run <code>npx browserslist</code> in project directory to see what browsers was selected
by your queries.</p>

<p><code>sh
$ npx browserslist
and_chr 61
and_ff 56
and_qq 1.2
and_uc 11.4
android 56
baidu 7.12
bb 10
chrome 62
edge 16
firefox 56
ios_saf 11
opera 48
safari 11
samsung 5
</code></p>

<h3>Notes</h3>

<p>Browserslist works with separated versions of browsers.
You should avoid queries like <code>Firefox > 0</code>.</p>

<p>Multiple criteria are combined as a boolean <code>OR</code>. A browser version must match
at least one of the criteria to be selected.</p>

<p>All queries are based on the <a href="http://caniuse.com/">Can I Use</a> support table,
e.g. <code>last 3 iOS versions</code> might select <code>8.4, 9.2, 9.3</code> (mixed major and minor),
whereas <code>last 3 Chrome versions</code> might select <code>50, 49, 48</code> (major only).</p>

<h3>Browsers</h3>

<p>Names are case insensitive:</p>

<ul>
  <li><code>Android</code> for Android WebView.</li>
  <li><code>Baidu</code> for Baidu Browser.</li>
  <li><code>BlackBerry</code> or <code>bb</code> for Blackberry browser.</li>
  <li><code>Chrome</code> for Google Chrome.</li>
  <li><code>ChromeAndroid</code> or <code>and_chr</code> for Chrome for Android</li>
  <li><code>Edge</code> for Microsoft Edge.</li>
  <li><code>Electron</code> for Electron framework. It will be converted to Chrome version.</li>
  <li><code>Explorer</code> or <code>ie</code> for Internet Explorer.</li>
  <li><code>ExplorerMobile</code> or <code>ie_mob</code> for Internet Explorer Mobile.</li>
  <li><code>Firefox</code> or <code>ff</code> for Mozilla Firefox.</li>
  <li><code>FirefoxAndroid</code> or <code>and_ff</code> for Firefox for Android.</li>
  <li><code>iOS</code> or <code>ios_saf</code> for iOS Safari.</li>
  <li><code>Opera</code> for Opera.</li>
  <li><code>OperaMini</code> or <code>op_mini</code> for Opera Mini.</li>
  <li><code>OperaMobile</code> or <code>op_mob</code> for Opera Mobile.</li>
  <li><code>QQAndroid</code> or <code>and_qq</code> for QQ Browser for Android.</li>
  <li><code>Safari</code> for desktop Safari.</li>
  <li><code>Samsung</code> for Samsung Internet.</li>
  <li><code>UCAndroid</code> or <code>and_uc</code> for UC Browser for Android.</li>
</ul>

<h2><code>package.json</code></h2>

<p>If you want to reduce config files in project root, you can specify
browsers in <code>package.json</code> with <code>browserslist</code> key:</p>

<p><code>json
{
  "private": true,
  "dependencies": {
    "autoprefixer": "^6.5.4"
  },
  "browserslist": [
    "> 1%",
    "last 2 versions"
  ]
}
</code></p>

<h2>Config File</h2>

<p>Browserslist config should be named <code>.browserslistrc</code> or <code>browserslist</code>
and have browsers queries split by a new line. Comments starts with <code>#</code> symbol:</p>

<p>```yaml
# Browsers that we support</p>

<blockquote>
  <p>1%
Last 2 versions
IE 8 # sorry
```</p>
</blockquote>

<p>Browserslist will check config in every directory in <code>path</code>.
So, if tool process <code>app/styles/main.css</code>, you can put config to root,
<code>app/</code> or <code>app/styles</code>.</p>

<p>You can specify direct path in <code>BROWSERSLIST_CONFIG</code> environment variables.</p>

<h2>Shareable Configs</h2>

<p>You can use the following query to reference an exported Browserslist config
from another package:</p>

<p><code>json
  "browserslist": [
    "extends browserslist-config-mycompany"
  ]
</code></p>

<p>For security reasons, external configuration only supports packages that have
the <code>browserslist-config-</code> prefix. npm scoped packages are also supported, by
naming or prefixing the module with <code>@scope/browserslist-config</code>, such as
<code>@scope/browserslist-config</code> or <code>@scope/browserslist-config-mycompany</code>.</p>

<p>If you don’t accept Browserslist queries from users, you can disable the
validation by using the <code>dangerousExtend</code> option:</p>

<p><code>js
browserslist(queries, { path, dangerousExtend: true })
</code></p>

<p>Because this uses <code>npm</code>’s resolution, you can also reference specific files
in a package:</p>

<p><code>json
  "browserslist": [
    "extends browserslist-config-mycompany/desktop",
    "extends browserslist-config-mycompany/mobile"
  ]
</code></p>

<p>When writing a shared Browserslist package, just export an array.
<code>browserslist-config-mycompany/index.js</code>:</p>

<p><code>js
module.exports = [
  'last 2 versions',
  'ie 9'
]
</code></p>

<h2>Environment Variables</h2>

<p>If some tool use Browserslist inside, you can change browsers settings
by <a href="https://en.wikipedia.org/wiki/Environment_variable">environment variables</a>:</p>

<ul>
  <li>
    <p><code>BROWSERSLIST</code> with browsers queries.</p>

    <p><code>sh
BROWSERSLIST="> 5%" gulp css
</code></p>
  </li>
  <li>
    <p><code>BROWSERSLIST_CONFIG</code> with path to config file.</p>

    <p><code>sh
BROWSERSLIST_CONFIG=./config/browserslist gulp css
</code></p>
  </li>
  <li>
    <p><code>BROWSERSLIST_ENV</code> with environments string.</p>

    <p><code>sh
BROWSERSLIST_ENV="development" gulp css
</code></p>
  </li>
  <li>
    <p><code>BROWSERSLIST_STATS</code> with path to the custom usage data
for <code>> 1% in my stats</code> query.</p>

    <p><code>sh
BROWSERSLIST_STATS=./config/usage_data.json gulp css
</code></p>
  </li>
  <li>
    <p><code>BROWSERSLIST_DISABLE_CACHE</code> if you want to disable config reading cache.</p>

    <p><code>sh
BROWSERSLIST_DISABLE_CACHE=1 gulp css
</code></p>
  </li>
</ul>

<h2>Environments</h2>

<p>You can also specify different browser queries for various environments.
Browserslist will choose query according to <code>BROWSERSLIST_ENV</code> or <code>NODE_ENV</code>
variables. If none of them is declared, Browserslist will firstly look
for <code>development</code> queries and then use defaults.</p>

<p>In <code>package.json</code>:</p>

<p><code>js
  "browserslist": {
    "production": [
      "last 2 version",
      "ie 9"
    ],
    "development": [
      "last 1 version"
    ]
  }
</code></p>

<p>In <code>.browserslistrc</code> config:</p>

<p>```ini
[production]
last 2 version
ie 9</p>

<p>[development]
last 1 version
```</p>

<h2>Custom Usage Data</h2>

<p>If you have a website, you can query against the usage statistics of your site:</p>

<ol>
  <li>Import your Google Analytics data into <a href="http://caniuse.com/">Can I Use</a>.
Press <code>Import…</code> button in Settings page.</li>
  <li>
    <p>Open browser DevTools on <a href="http://caniuse.com/">Can I Use</a> and paste this snippet
into the browser console:</p>

    <p><code>js
var e=document.createElement('a');e.setAttribute('href', 'data:text/plain;charset=utf-8,'+encodeURIComponent(JSON.stringify(JSON.parse(localStorage['usage-data-by-id'])[localStorage['config-primary_usage']])));e.setAttribute('download','stats.json');document.body.appendChild(e);e.click();document.body.removeChild(e);
</code></p>
  </li>
  <li>Save the data to a <code>browserslist-stats.json</code> file in your project.</li>
</ol>

<p>Of course, you can generate usage statistics file by any other method.
File format should be like:</p>

<p><code>js
{
  "ie": {
    "6": 0.01,
    "7": 0.4,
    "8": 1.5
  },
  "chrome": {
    …
  },
  …
}
</code></p>

<p>Note that you can query against your custom usage data
while also querying against global or regional data.
For example, the query <code>> 1% in my stats, > 5% in US, 10%</code> is permitted.</p>

<h2>Webpack</h2>

<p>If you plan to use Browserslist on client-side (e. g., tools like CodePen)
Browserslist could take big part of your bundle — about 150 KB.</p>

<p>But the biggest part of this size will be region usage statistics, which could
be useless for you. You can use <code>IgnorePlugin</code> in webpack to cut it:</p>

<p><code>js
const webpackConfig = {
  …
  plugins: [
    new webpack.IgnorePlugin(/caniuse-lite\/data\/regions/)
  ]
}
</code></p>

<p>This plugin will reduce Browserslist size from 150 KB to 6 KB. But you loose
<code>> 1% in US</code> queries support.</p>

<h2>JS API</h2>

<p>```js
var browserslist = require(‘browserslist’);</p>

<p>// Your CSS/JS build tool code
var process = function (source, opts) {
    var browsers = browserslist(opts.browsers, {
        stats: opts.stats,
        path:  opts.file,
        env:   opts.env
    });
    // Your code to add features for selected browsers
}
```</p>

<p>Queries can be a string <code>"> 5%, last 1 version"</code>
or an array <code>['> 5%', 'last 1 version']</code>.</p>

<p>If a query is missing, Browserslist will look for a config file.
You can provide a <code>path</code> option (that can be a file) to find the config file
relatively to it.</p>

<p>For non-JS environment and debug purpose you can use CLI tool:</p>

<p><code>sh
browserslist "> 1%, last 2 versions"
</code></p>

<h2>Coverage</h2>

<p>You can get total users coverage for selected browsers by JS API:</p>

<p><code>js
browserslist.coverage(browserslist('> 1%')) //=> 81.4
</code></p>

<p><code>js
browserslist.coverage(browserslist('> 1% in US'), 'US') //=> 83.1
</code></p>

<p>Or by CLI:</p>

<p><code>sh
$ browserslist --coverage "> 1%"
These browsers account for 81.4% of all users globally
</code></p>

<p><code>sh
$ browserslist --coverage=US "> 1% in US"
These browsers account for 83.1% of all users in the US
</code></p>

<h2>Internal caches</h2>

<p>Browserslist caches the configuration it reads from <code>package.json</code> and
<code>browserslist</code> files, as well as knowledge about the existence of files,
for the duration of the hosting process.</p>

<p>To clear these caches, use:</p>

<p><code>js
browserslist.clearCaches();
</code></p>

<p>To disable the caching altogether, set the <code>BROWSERSLIST_DISABLE_CACHE</code>
environment variable.</p>