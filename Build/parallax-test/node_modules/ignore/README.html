<table><thead>
  <tr>
    <th>Linux</th>
    <th>OS X</th>
    <th>Windows</th>
    <th>Coverage</th>
    <th>Downloads</th>
  </tr>
</thead><tbody><tr>
  <td colspan="2" align="center">
    <a href="https://travis-ci.org/kaelzhang/node-ignore">
    <img src="https://travis-ci.org/kaelzhang/node-ignore.svg?branch=master" alt="Build Status" /></a>
  </td>
  <td align="center">
    <a href="https://ci.appveyor.com/project/kaelzhang/node-ignore">
    <img src="https://ci.appveyor.com/api/projects/status/github/kaelzhang/node-ignore?branch=master&svg=true" alt="Windows Build Status" /></a>
  </td>
  <td align="center">
    <a href="https://codecov.io/gh/kaelzhang/node-ignore">
    <img src="https://codecov.io/gh/kaelzhang/node-ignore/branch/master/graph/badge.svg" alt="Coverage Status" /></a>
  </td>
  <td align="center">
    <a href="https://www.npmjs.org/package/ignore">
    <img src="http://img.shields.io/npm/dm/ignore.svg" alt="npm module downloads per month" /></a>
  </td>
</tr></tbody></table>

<h1>ignore</h1>

<p><code>ignore</code> is a manager, filter and parser which implemented in pure JavaScript according to the .gitignore <a href="http://git-scm.com/docs/gitignore">spec</a>.</p>

<p>Pay attention that <a href="https://www.npmjs.org/package/minimatch"><code>minimatch</code></a> does not work in the gitignore way. To filter filenames according to .gitignore file, I recommend this module.</p>

<h5>Tested on</h5>

<ul>
  <li>Linux + Node: <code>0.8</code> - <code>7.x</code></li>
  <li>Windows + Node: <code>0.10</code> - <code>7.x</code>, node < <code>0.10</code> is not tested due to the lack of support of appveyor.</li>
</ul>

<p>Actually, <code>ignore</code> does not rely on any versions of node specially.</p>

<h2>Table Of Main Contents</h2>

<ul>
  <li><a href="#usage">Usage</a></li>
  <li><a href="#upgrade-2x---3x">Guide for 2.x -> 3.x</a></li>
  <li><a href="#contributing">Contributing</a></li>
  <li>Related Packages
    <ul>
      <li><a href="https://www.npmjs.com/package/glob-gitignore"><code>glob-gitignore</code></a> matches files using patterns and filters them according to gitignore rules.</li>
    </ul>
  </li>
</ul>

<h2>Usage</h2>

<p><code>js
const ignore = require('ignore')
const ig = ignore().add(['.abc/*', '!.abc/d/'])
</code></p>

<h3>Filter the given paths</h3>

<p>```js
const paths = [
  ‘.abc/a.js’,    // filtered out
  ‘.abc/d/e.js’   // included
]</p>

<p>ig.filter(paths)        // [‘.abc/d/e.js’]
ig.ignores(‘.abc/a.js’) // true
```</p>

<h3>As the filter function</h3>

<p><code>js
paths.filter(ig.createFilter()); // ['.abc/d/e.js']
</code></p>

<h3>Win32 paths will be handled</h3>

<p><code>js
ig.filter(['.abc\\a.js', '.abc\\d\\e.js'])
// if the code above runs on windows, the result will be
// ['.abc\\d\\e.js']
</code></p>

<h2>Why another ignore?</h2>

<ul>
  <li>
    <p><code>ignore</code> is a standalone module, and is much simpler so that it could easy work with other programs, unlike <a href="https://npmjs.org/~isaacs">isaacs</a>’s <a href="https://npmjs.org/package/fstream-ignore">fstream-ignore</a> which must work with the modules of the fstream family.</p>
  </li>
  <li><code>ignore</code> only contains utility methods to filter paths according to the specified ignore rules, so
    <ul>
      <li><code>ignore</code> never try to find out ignore rules by traversing directories or fetching from git configurations.</li>
      <li><code>ignore</code> don’t cares about sub-modules of git projects.</li>
    </ul>
  </li>
  <li>Exactly according to <a href="http://git-scm.com/docs/gitignore">gitignore man page</a>, fixes some known matching issues of fstream-ignore, such as:
    <ul>
      <li>’<code>/*.js</code>’ should only match ‘<code>a.js</code>’, but not ‘<code>abc/a.js</code>’.</li>
      <li>’<code>**/foo</code>’ should match ‘<code>foo</code>’ anywhere.</li>
      <li>Prevent re-including a file if a parent directory of that file is excluded.</li>
      <li>Handle trailing whitespaces:
        <ul>
          <li><code>'a '</code>(one space) should not match <code>'a  '</code>(two spaces).</li>
          <li><code>'a \ '</code> matches <code>'a  '</code></li>
        </ul>
      </li>
      <li>All test cases are verified with the result of <code>git check-ignore</code>.</li>
    </ul>
  </li>
</ul>

<h2>Methods</h2>

<h3>.add(pattern)</h3>
<p>### .add(patterns)</p>

<ul>
  <li><strong>pattern</strong> <code>String|Ignore</code> An ignore pattern string, or the <code>Ignore</code> instance</li>
  <li><strong>patterns</strong> <code>Array.<pattern></code> Array of ignore patterns.</li>
</ul>

<p>Adds a rule or several rules to the current manager.</p>

<p>Returns <code>this</code></p>

<p>Notice that a line starting with <code>'#'</code>(hash) is treated as a comment. Put a backslash (<code>'\'</code>) in front of the first hash for patterns that begin with a hash, if you want to ignore a file with a hash at the beginning of the filename.</p>

<p><code>js
ignore().add('#abc').ignores('#abc')    // false
ignore().add('\#abc').ignores('#abc')   // true
</code></p>

<p><code>pattern</code> could either be a line of ignore pattern or a string of multiple ignore patterns, which means we could just <code>ignore().add()</code> the content of a ignore file:</p>

<p><code>js
ignore()
.add(fs.readFileSync(filenameOfGitignore).toString())
.filter(filenames)
</code></p>

<p><code>pattern</code> could also be an <code>ignore</code> instance, so that we could easily inherit the rules of another <code>Ignore</code> instance.</p>

<h3><strike>.addIgnoreFile(path)</strike></h3>

<p>REMOVED in <code>3.x</code> for now.</p>

<p>To upgrade <code>ignore@2.x</code> up to <code>3.x</code>, use</p>

<p>```js
const fs = require(‘fs’)</p>

<p>if (fs.existsSync(filename)) {
  ignore().add(fs.readFileSync(filename).toString())
}
```</p>

<p>instead.</p>

<h3>.ignores(pathname)</h3>

<blockquote>
  <p>new in 3.2.0</p>
</blockquote>

<p>Returns <code>Boolean</code> whether <code>pathname</code> should be ignored.</p>

<p><code>js
ig.ignores('.abc/a.js')    // true
</code></p>

<h3>.filter(paths)</h3>

<p>Filters the given array of pathnames, and returns the filtered array.</p>

<ul>
  <li><strong>paths</strong> <code>Array.<path></code> The array of <code>pathname</code>s to be filtered.</li>
</ul>

<p><strong>NOTICE</strong> that:</p>

<ul>
  <li><code>pathname</code> should be a string that have been <code>path.join()</code>ed, or the return value of <code>path.relative()</code> to the current directory.</li>
</ul>

<p>```js
// WRONG
ig.ignores(‘./abc’)</p>

<p>// WRONG, for it will never happen.
// If the gitignore rule locates at the root directory,
// <code>'/abc'</code> should be changed to <code>'abc'</code>.
// <code>
// path.relative('/', '/abc')  -> 'abc'
//</code>
ig.ignores(‘/abc’)</p>

<p>// Right
ig.ignores(‘abc’)</p>

<p>// Right
ig.ignores(path.join(‘./abc’))  // path.join(‘./abc’) -> ‘abc’
```</p>

<ul>
  <li>In other words, each <code>pathname</code> here should be a relative path to the directory of the git ignore rules.</li>
</ul>

<p>Suppose the dir structure is:</p>

<p><code>
/path/to/your/repo
    |-- a
    |   |-- a.js
    |
    |-- .b
    |
    |-- .c
         |-- .DS_store
</code></p>

<p>Then the <code>paths</code> might be like this:</p>

<p><code>js
[
  'a/a.js'
  '.b',
  '.c/.DS_store'
]
</code></p>

<p>Usually, you could use <a href="http://npmjs.org/package/glob"><code>glob</code></a> with <code>option.mark = true</code> to fetch the structure of the current directory:</p>

<p>```js
const glob = require(‘glob’)</p>

<p>glob(‘**’, {
  // Adds a / character to directory matches.
  mark: true
}, (err, files) => {
  if (err) {
    return console.error(err)
  }</p>

<p>let filtered = ignore().add(patterns).filter(files)
  console.log(filtered)
})
```</p>

<h3>.createFilter()</h3>

<p>Creates a filter function which could filter an array of paths with <code>Array.prototype.filter</code>.</p>

<p>Returns <code>function(path)</code> the filter function.</p>

<hr />

<h2>Upgrade 2.x -> 3.x</h2>

<ul>
  <li>All <code>options</code> of 2.x are unnecessary and removed, so just remove them.</li>
  <li><code>ignore()</code> instance is no longer an <a href="nodejs.org/api/events.html"><code>EventEmitter</code></a>, and all events are unnecessary and removed.</li>
  <li><code>.addIgnoreFile()</code> is removed, see the <a href="#addignorefilepath">.addIgnoreFile</a> section for details.</li>
</ul>

<hr />

<h2>Contributing</h2>

<p>The code of <code>node-ignore</code> is based on es6 and babel, but babel and its preset is not included in the <code>dependencies</code> field of package.json, so that the installation process of test cases will not fail in older versions of node.</p>

<p>So use <code>bash install.sh</code> to install dependencies and <code>bash test.sh</code> to run test cases in your local machine.</p>

<h4>Collaborators</h4>

<ul>
  <li><a href="https://github.com/SamyPesse">SamyPesse</a> <em>Samy Pessé</em></li>
  <li><a href="https://github.com/azproduction">azproduction</a> <em>Mikhail Davydov</em></li>
  <li><a href="https://github.com/TrySound">TrySound</a> <em>Bogdan Chadkin</em></li>
  <li><a href="https://github.com/JanMattner">JanMattner</a> <em>Jan Mattner</em></li>
</ul>