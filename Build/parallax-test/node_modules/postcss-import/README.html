<h1>postcss-import</h1>

<p><a href="https://travis-ci.org/postcss/postcss-import"><img src="https://img.shields.io/travis/postcss/postcss-import/master.svg?branch=master&label=unix%20build" alt="Unix Build status" /></a>
<a href="https://ci.appveyor.com/project/MoOx/postcss-import/branch/master"><img src="https://img.shields.io/appveyor/ci/MoOx/postcss-import/master.svg?label=window%20build" alt="Windows Build status" /></a>
<a href="https://github.com/postcss/postcss-import/blob/master/CHANGELOG.md"><img src="https://img.shields.io/npm/v/postcss-import.svg" alt="Version" /></a></p>

<blockquote>
  <p><a href="https://github.com/postcss/postcss">PostCSS</a> plugin to transform <code>@import</code>
rules by inlining content.</p>
</blockquote>

<p>This plugin can consume local files, node modules or web_modules.
To resolve path of an <code>@import</code> rule, it can look into root directory
(by default <code>process.cwd()</code>), <code>web_modules</code>, <code>node_modules</code>
or local modules.
<em>When importing a module, it will look for <code>index.css</code> or file referenced in
<code>package.json</code> in the <code>style</code> or <code>main</code> fields.</em>
You can also provide manually multiples paths where to look at.</p>

<p><strong>Notes:</strong></p>

<ul>
  <li><strong>This plugin should probably be used as the first plugin of your list.
This way, other plugins will work on the AST as if there were only a single file
to process, and will probably work as you can expect</strong>.</li>
  <li>This plugin works great with
<a href="https://github.com/postcss/postcss-url">postcss-url</a> plugin,
which will allow you to adjust assets <code>url()</code> (or even inline them) after
inlining imported files.</li>
  <li>In order to optimize output, <strong>this plugin will only import a file once</strong> on
a given scope (root, media query…).
Tests are made from the path & the content of imported files (using a hash
table).
If this behavior is not what you want, look at <code>skipDuplicates</code> option</li>
  <li><strong>If you are looking for glob, or sass like imports (prefixed partials)</strong>,
please look at
<a href="https://github.com/trysound/postcss-easy-import">postcss-easy-import</a>
(which use this plugin under the hood).</li>
  <li><strong>This plugin attempts to follow the CSS <code>@import</code> spec</strong>; <code>@import</code>
statements must precede all other statements (besides <code>@charset</code>).</li>
</ul>

<h2>Installation</h2>

<p><code>console
$ npm install postcss-import
</code></p>

<h2>Usage</h2>

<p>Unless your stylesheet is in the same place where you run postcss
(<code>process.cwd()</code>), you will need to use <code>from</code> option to make relative imports
work.</p>

<p>```js
// dependencies
var fs = require(“fs”)
var postcss = require(“postcss”)
var atImport = require(“postcss-import”)</p>

<p>// css to be processed
var css = fs.readFileSync(“css/input.css”, “utf8”)</p>

<p>// process css
postcss()
  .use(atImport())
  .process(css, {
    // <code>from</code> option is needed here
    from: “css/input.css”
  })
  .then(function (result) {
    var output = result.css</p>

<pre><code>console.log(output)   }) ```
</code></pre>

<p><code>css/input.css</code>:</p>

<p>```css
/* can consume <code>node_modules</code>, <code>web_modules</code> or local modules <em>/
@import “cssrecipes-defaults”; /</em> == @import “../node_modules/cssrecipes-defaults/index.css”; <em>/
@import “normalize.css”; /</em> == @import “../node_modules/normalize.css/normalize.css”; */</p>

<p>@import “foo.css”; /* relative to css/ according to <code>from</code> option above */</p>

<p>@import “bar.css” (min-width: 25em);</p>

<p>body {
  background: black;
}
```</p>

<p>will give you:</p>

<p>```css
/* … content of ../node_modules/cssrecipes-defaults/index.css <em>/
/</em> … content of ../node_modules/normalize.css/normalize.css */</p>

<p>/* … content of css/foo.css */</p>

<p>@media (min-width: 25em) {
/* … content of css/bar.css */
}</p>

<p>body {
  background: black;
}
```</p>

<p>Checkout the <a href="test">tests</a> for more examples.</p>

<h3>Options</h3>

<h4><code>root</code></h4>

<p>Type: <code>String</code><br />
Default: <code>process.cwd()</code> or <em>dirname of
<a href="https://github.com/postcss/postcss#node-source">the postcss <code>from</code></a></em></p>

<p>Define the root where to resolve path (eg: place where <code>node_modules</code> are).
Should not be used that much.<br />
<em>Note: nested <code>@import</code> will additionally benefit of the relative dirname of
imported files.</em></p>

<h4><code>path</code></h4>

<p>Type: <code>String|Array</code><br />
Default: <code>[]</code></p>

<p>A string or an array of paths in where to look for files.</p>

<h4><code>plugins</code></h4>

<p>Type: <code>Array</code><br />
Default: <code>undefined</code></p>

<p>An array of plugins to be applied on each imported files.</p>

<h4><code>resolve</code></h4>

<p>Type: <code>Function</code><br />
Default: <code>null</code></p>

<p>You can provide a custom path resolver with this option. This function gets
<code>(id, basedir, importOptions)</code> arguments and should return a path, an array of
paths or a promise resolving to the path(s). If you do not return an absolute
path, your path will be resolved to an absolute path using the default
resolver.
You can use <a href="https://github.com/substack/node-resolve">resolve</a> for this.</p>

<h4><code>load</code></h4>

<p>Type: <code>Function</code><br />
Default: null</p>

<p>You can overwrite the default loading way by setting this option.
This function gets <code>(filename, importOptions)</code> arguments and returns content or
promised content.</p>

<h4><code>skipDuplicates</code></h4>

<p>Type: <code>Boolean</code><br />
Default: <code>true</code></p>

<p>By default, similar files (based on the same content) are being skipped.
It’s to optimize output and skip similar files like <code>normalize.css</code> for example.
If this behavior is not what you want, just set this option to <code>false</code> to
disable it.</p>

<h4><code>addModulesDirectories</code></h4>

<p>Type: <code>Array</code><br />
Default: <code>[]</code></p>

<p>An array of folder names to add to <a href="https://github.com/substack/node-resolve">Node’s resolver</a>.
Values will be appended to the default resolve directories:
<code>["node_modules", "web_modules"]</code>.</p>

<p>This option is only for adding additional directories to default resolver. If
you provide your own resolver via the <code>resolve</code> configuration option above, then
this value will be ignored.</p>

<h4>Example with some options</h4>

<p>```js
var postcss = require(“postcss”)
var atImport = require(“postcss-import”)</p>

<p>postcss()
  .use(atImport({
    path: [“src/css”],
  }))
  .process(cssString)
  .then(function (result) {
    var css = result.css
  })
```</p>

<h2><code>dependency</code> Message Support</h2>

<p><code>postcss-import</code> adds a message to <code>result.messages</code> for each <code>@import</code>. Messages are in the following format:</p>

<p><code>
{
  type: 'dependency',
  file: absoluteFilePath,
  parent: fileContainingTheImport
}
</code></p>

<p>This is mainly for use by postcss runners that implement file watching.</p>

<hr />

<h2>CONTRIBUTING</h2>

<ul>
  <li>⇄ Pull requests and ★ Stars are always welcome.</li>
  <li>For bugs and feature requests, please create an issue.</li>
  <li>Pull requests must be accompanied by passing automated tests (<code>$ npm test</code>).</li>
</ul>

<h2><a href="CHANGELOG.md">Changelog</a></h2>

<h2><a href="LICENSE">License</a></h2>