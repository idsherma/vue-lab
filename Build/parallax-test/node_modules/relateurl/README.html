<h1>relateurl <a href="https://npmjs.org/package/relateurl"><img src="https://img.shields.io/npm/v/relateurl.svg" alt="NPM Version" /></a> <a href="https://travis-ci.org/stevenvachon/relateurl"><img src="https://img.shields.io/travis/stevenvachon/relateurl.svg" alt="Build Status" /></a> <a href="https://david-dm.org/stevenvachon/relateurl"><img src="https://img.shields.io/david/stevenvachon/relateurl.svg" alt="Dependency Status" /></a></h1>

<blockquote>
  <p>Minify URLs by converting them from absolute to relative.</p>
</blockquote>

<p>If you were to use this library on a website like <code>http://example.com/dir1/dir1-1/</code>, you would get results such as:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Before</th>
      <th style="text-align: left">After</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code>http://example.com/dir1/dir1-2/index.html</code></td>
      <td style="text-align: left"><code>../dir1-2/</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>http://example.com/dir2/dir2-1/</code></td>
      <td style="text-align: left"><code>/dir2/dir2-1/</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>http://example.com/dir1/dir1-1/</code></td>
      <td style="text-align: left"><code> </code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>https://example.com/dir1/dir1-1/</code></td>
      <td style="text-align: left"><code>https://example.com/dir1/dir1-1/</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>http://google.com:80/dir/</code></td>
      <td style="text-align: left"><code>//google.com/dir/</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>../../../../../../../../#anchor</code></td>
      <td style="text-align: left"><code>/#anchor</code></td>
    </tr>
  </tbody>
</table>

<p><strong>All string parsing.</strong> <em>No</em> directory browsing. It is thoroughly tested, very fast and lightweight with zero external dependencies.</p>

<h2>Getting Started</h2>

<p>This utility requires <a href="http://nodejs.org/">Node.js</a> <code>>= 0.10</code>. To install, type this at the command line:
<code>
npm install relateurl --save-dev
</code></p>

<h3>Options</h3>

<h4>options.defaultPorts</h4>
<p>Type: <code>Object</code> <br />
Default value: <code>{ftp:21, http:80, https:443}</code>  </p>

<p>Extend the list with any ports you need. Any URLs containing these default ports will have them removed. Example: <code>http://example.com:80/</code> will become <code>http://example.com/</code>.</p>

<h4>options.directoryIndexes</h4>
<p>Type: <code>Array</code> <br />
Default value: <code>["index.html"]</code>  </p>

<p>Extend the list with any resources you need. Works with <a href="#options.removeDirectoryIndexes"><code>options.removeDirectoryIndexes</code></a>.</p>

<h4>options.ignore_www</h4>
<p>Type: <code>Boolean</code><br />
Default value: <code>false</code>  </p>

<p>This will, for example, consider any domains containing <code>http://www.example.com/</code> to be related to any that contain <code>http://example.com/</code>.</p>

<h4>options.output</h4>
<p>Type: constant or <code>String</code><br />
Choices: <code>RelateUrl.ABSOLUTE</code>,<code>RelateUrl.PATH_RELATIVE</code>,<code>RelateUrl.ROOT_RELATIVE</code>,<code>RelateUrl.SHORTEST</code><br />
Choices: <code>"absolute"</code>,<code>"pathRelative"</code>,<code>"rootRelative"</code>,<code>"shortest"</code><br />
Default value: <code>RelateUrl.SHORTEST</code>  </p>

<p><code>RelateUrl.ABSOLUTE</code> will produce an absolute URL. Overrides <a href="#options.schemeRelative"><code>options.schemeRelative</code></a> with a value of <code>false</code>.<br />
<code>RelateUrl.PATH_RELATIVE</code> will produce something like <code>../child-of-parent/etc/</code>.<br />
<code>RelateUrl.ROOT_RELATIVE</code> will produce something like <code>/child-of-root/etc/</code>.<br />
<code>RelateUrl.SHORTEST</code> will choose whichever is shortest between root- and path-relative.  </p>

<h4>options.rejectedSchemes</h4>
<p>Type: <code>Array</code> <br />
Default value: <code>["data","javascript","mailto"]</code>  </p>

<p>Extend the list with any additional schemes. Example: <code>javascript:something</code> will not be modified.</p>

<h4>options.removeAuth</h4>
<p>Type: <code>Boolean</code> <br />
Default value: <code>false</code>  </p>

<p>Remove user authentication information from the output URL.</p>

<h4>options.removeDirectoryIndexes</h4>
<p>Type: <code>Boolean</code> <br />
Default value: <code>true</code>  </p>

<p>Remove any resources that match any found in <a href="#options.directoryIndexes"><code>options.directoryIndexes</code></a>.</p>

<h4>options.removeEmptyQueries</h4>
<p>Type: <code>Boolean</code> <br />
Default value: <code>false</code>  </p>

<p>Remove empty query variables. Example: <code>http://domain.com/?var1&var2=&var3=asdf</code> will become <code>http://domain.com/?var3=adsf</code>. This does not apply to unrelated URLs (with other protocols, auths, hosts and/or ports).</p>

<h4>options.removeRootTrailingSlash</h4>
<p>Type: <code>Boolean</code> <br />
Default value: <code>true</code>  </p>

<p>Remove trailing slashes from root paths. Example: <code>http://domain.com/?var</code> will become <code>http://domain.com?var</code> while <code>http://domain.com/dir/?var</code> will not be modified.</p>

<h4>options.schemeRelative</h4>
<p>Type: <code>Boolean</code> <br />
Default value: <code>true</code>  </p>

<p>Output URLs relative to the scheme. Example: <code>http://example.com/</code> will become <code>//example.com/</code>.</p>

<h4>options.site</h4>
<p>Type: <code>String</code> <br />
Default value: <code>undefined</code>  </p>

<p>An options-based version of the <a href="#examples"><code>from</code></a> argument. If both are specified, <code>from</code> takes priority.</p>

<h4>options.slashesDenoteHost</h4>
<p>Type: <code>Boolean</code> <br />
Default value: <code>true</code>  </p>

<p>Passed to Node’s <a href="http://nodejs.org/api/url.html#url_url_parse_urlstr_parsequerystring_slashesdenotehost"><code>url.parse</code></a>.</p>

<h3>Examples</h3>
<p>This library can be used as a <a href="#single-instance">function for single-use</a> or as a <a href="#reusable-instances">class for multiple conversions</a>.</p>

<p>Upon successful conversion, a <code>String</code> will be returned. If an issue is encountered while parsing <code>from</code>, an error will be thrown.</p>

<h4>Single Instance</h4>
<p>```js
var RelateUrl = require(“relateurl”);</p>

<p>var result = RelateUrl.relate(from, to, options);
```</p>

<h4>Reusable Instances</h4>
<p>```js
var RelateUrl = require(“relateurl”);</p>

<p>var instance = new RelateUrl(from, options);</p>

<p>var result1 = instance.relate(to1);
var result2 = instance.relate(to2, customOptions);
var result3 = instance.relate(to3);
```</p>

<h2>FAQ</h2>
<ol>
  <li>
    <p><strong>Why bother writing/using this?</strong><br />
To aid in further minifying HTML, mainly for the purpose of faster page loads and SEO. It’s been integrated into <a href="https://github.com/kangax/html-minifier">HTMLMinifier</a>.</p>
  </li>
  <li>
    <p><strong>Why not just use Node’s <code>url.parse</code>, <code>url.resolve</code> and <code>path.relative</code>?</strong><br />
<code>url.parse</code> <em>is</em> used, but <code>url.resolve</code> and <code>path.relative</code> are both slower and less powerful than this library.</p>
  </li>
</ol>

<h2>Release History</h2>
<ul>
  <li>0.2.7 Node v6 support</li>
  <li>0.2.6 minor enhancements</li>
  <li>0.2.5 added <code>options.removeRootTrailingSlash</code></li>
  <li>0.2.4 added <code>options.site</code></li>
  <li>0.2.3 added browserify npm-script</li>
  <li>0.2.2 removed task runner</li>
  <li>0.2.1 shorten resource- and query-relative URLs, test variations list with other site URLs</li>
  <li>0.2.0 code cleanup, <code>options.removeEmptyQueries=true</code> only applied to unrelated URLs</li>
  <li>0.1.0 initial release</li>
</ul>

<h2>Roadmap</h2>
<ul>
  <li>0.2.8 check if queries are the same, regardless of param order</li>
  <li>0.2.8 possible <a href="http://www.iana.org/assignments/uri-schemes/uri-schemes.xhtml">scheme exclusions</a> such as <code>tel:</code></li>
  <li>0.2.8 decipher and return invalid input (special cases) to complete test suite</li>
  <li>0.3.0 test <code>options.slashesDenoteHost=false</code>, add something like <code>options.externalDirectoryIndexes=[]</code> for external sites</li>
</ul>