<h1>Form-Data <a href="https://www.npmjs.com/package/form-data"><img src="https://img.shields.io/npm/v/form-data.svg" alt="NPM Module" /></a> <a href="https://gitter.im/form-data/form-data"><img src="http://form-data.github.io/images/gitterbadge.svg" alt="Join the chat at https://gitter.im/form-data/form-data" /></a></h1>

<p>A library to create readable <code>"multipart/form-data"</code> streams. Can be used to submit forms and file uploads to other web applications.</p>

<p>The API of this library is inspired by the <a href="http://dev.w3.org/2006/webapi/XMLHttpRequest-2/Overview.html#the-formdata-interface">XMLHttpRequest-2 FormData Interface</a>.</p>

<p><a href="https://travis-ci.org/form-data/form-data"><img src="https://img.shields.io/travis/form-data/form-data/v2.1.4.svg?label=linux:0.12-6.x" alt="Linux Build" /></a>
<a href="https://travis-ci.org/form-data/form-data"><img src="https://img.shields.io/travis/form-data/form-data/v2.1.4.svg?label=macos:0.12-6.x" alt="MacOS Build" /></a>
<a href="https://ci.appveyor.com/project/alexindigo/form-data"><img src="https://img.shields.io/appveyor/ci/alexindigo/form-data/v2.1.4.svg?label=windows:0.12-6.x" alt="Windows Build" /></a></p>

<p><a href="https://coveralls.io/github/form-data/form-data?branch=master"><img src="https://img.shields.io/coveralls/form-data/form-data/v2.1.4.svg?label=code+coverage" alt="Coverage Status" /></a>
<a href="https://david-dm.org/form-data/form-data"><img src="https://img.shields.io/david/form-data/form-data.svg" alt="Dependency Status" /></a>
<a href="https://www.bithound.io/github/form-data/form-data"><img src="https://www.bithound.io/github/form-data/form-data/badges/score.svg" alt="bitHound Overall Score" /></a></p>

<h2>Install</h2>

<p><code>
npm install --save form-data
</code></p>

<h2>Usage</h2>

<p>In this example we are constructing a form with 3 fields that contain a string,
a buffer and a file stream.</p>

<p>``` javascript
var FormData = require(‘form-data’);
var fs = require(‘fs’);</p>

<p>var form = new FormData();
form.append(‘my_field’, ‘my value’);
form.append(‘my_buffer’, new Buffer(10));
form.append(‘my_file’, fs.createReadStream(‘/foo/bar.jpg’));
```</p>

<p>Also you can use http-response stream:</p>

<p>``` javascript
var FormData = require(‘form-data’);
var http = require(‘http’);</p>

<p>var form = new FormData();</p>

<p>http.request(‘http://nodejs.org/images/logo.png’, function(response) {
  form.append(‘my_field’, ‘my value’);
  form.append(‘my_buffer’, new Buffer(10));
  form.append(‘my_logo’, response);
});
```</p>

<p>Or @mikeal’s <a href="https://github.com/request/request">request</a> stream:</p>

<p>``` javascript
var FormData = require(‘form-data’);
var request = require(‘request’);</p>

<p>var form = new FormData();</p>

<p>form.append(‘my_field’, ‘my value’);
form.append(‘my_buffer’, new Buffer(10));
form.append(‘my_logo’, request(‘http://nodejs.org/images/logo.png’));
```</p>

<p>In order to submit this form to a web application, call <code>submit(url, [callback])</code> method:</p>

<p>``` javascript
form.submit(‘http://example.org/’, function(err, res) {
  // res – response object (http.IncomingMessage)  //
  res.resume();
});</p>

<p>```</p>

<p>For more advanced request manipulations <code>submit()</code> method returns <code>http.ClientRequest</code> object, or you can choose from one of the alternative submission methods.</p>

<h3>Alternative submission methods</h3>

<p>You can use node’s http client interface:</p>

<p>``` javascript
var http = require(‘http’);</p>

<p>var request = http.request({
  method: ‘post’,
  host: ‘example.org’,
  path: ‘/upload’,
  headers: form.getHeaders()
});</p>

<p>form.pipe(request);</p>

<p>request.on(‘response’, function(res) {
  console.log(res.statusCode);
});
```</p>

<p>Or if you would prefer the <code>'Content-Length'</code> header to be set for you:</p>

<p><code>javascript
form.submit('example.org/upload', function(err, res) {
  console.log(res.statusCode);
});
</code></p>

<p>To use custom headers and pre-known length in parts:</p>

<p>``` javascript
var CRLF = ‘\r\n’;
var form = new FormData();</p>

<p>var options = {
  header: CRLF + ‘–’ + form.getBoundary() + CRLF + ‘X-Custom-Header: 123’ + CRLF + CRLF,
  knownLength: 1
};</p>

<p>form.append(‘my_buffer’, buffer, options);</p>

<p>form.submit(‘http://example.com/’, function(err, res) {
  if (err) throw err;
  console.log(‘Done’);
});
```</p>

<p>Form-Data can recognize and fetch all the required information from common types of streams (<code>fs.readStream</code>, <code>http.response</code> and <code>mikeal's request</code>), for some other types of streams you’d need to provide “file”-related information manually:</p>

<p>``` javascript
someModule.stream(function(err, stdout, stderr) {
  if (err) throw err;</p>

<p>var form = new FormData();</p>

<p>form.append(‘file’, stdout, {
    filename: ‘unicycle.jpg’,
    contentType: ‘image/jpg’,
    knownLength: 19806
  });</p>

<p>form.submit(‘http://example.com/’, function(err, res) {
    if (err) throw err;
    console.log(‘Done’);
  });
});
```</p>

<p>For edge cases, like POST request to URL with query string or to pass HTTP auth credentials, object can be passed to <code>form.submit()</code> as first parameter:</p>

<p><code>javascript
form.submit({
  host: 'example.com',
  path: '/probably.php?extra=params',
  auth: 'username:password'
}, function(err, res) {
  console.log(res.statusCode);
});
</code></p>

<p>In case you need to also send custom HTTP headers with the POST request, you can use the <code>headers</code> key in first parameter of <code>form.submit()</code>:</p>

<p><code>javascript
form.submit({
  host: 'example.com',
  path: '/surelynot.php',
  headers: {'x-test-header': 'test-header-value'}
}, function(err, res) {
  console.log(res.statusCode);
});
</code></p>

<h3>Integration with other libraries</h3>

<h4>Request</h4>

<p>Form submission using  <a href="https://github.com/request/request">request</a>:</p>

<p>```javascript
var formData = {
  my_field: ‘my_value’,
  my_file: fs.createReadStream(__dirname + ‘/unicycle.jpg’),
};</p>

<p>request.post({url:’http://service.com/upload’, formData: formData}, function(err, httpResponse, body) {
  if (err) {
    return console.error(‘upload failed:’, err);
  }
  console.log(‘Upload successful!  Server responded with:’, body);
});
```</p>

<p>For more details see <a href="https://github.com/request/request#multipartform-data-multipart-form-uploads">request readme</a>.</p>

<h4>node-fetch</h4>

<p>You can also submit a form using <a href="https://github.com/bitinn/node-fetch">node-fetch</a>:</p>

<p>```javascript
var form = new FormData();</p>

<p>form.append(‘a’, 1);</p>

<p>fetch(‘http://example.com’, { method: ‘POST’, body: form })
    .then(function(res) {
        return res.json();
    }).then(function(json) {
        console.log(json);
    });
```</p>

<h2>Notes</h2>

<ul>
  <li><code>getLengthSync()</code> method DOESN’T calculate length for streams, use <code>knownLength</code> options as workaround.</li>
  <li>Starting version <code>2.x</code> FormData has dropped support for <code>node@0.10.x</code>.</li>
</ul>

<h2>License</h2>

<p>Form-Data is released under the <a href="License">MIT</a> license.</p>